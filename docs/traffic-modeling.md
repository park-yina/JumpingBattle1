# Traffic Modeling

## 1. 서비스 특성 및 트래픽 구조

점핑배틀은 순수 온라인 기반 웹서비스가 아닌,  
오프라인 매장 기반 게임 서비스입니다.

- 매장당 방 개수 제한 존재
- 방당 동시 플레이 1팀
- 평균 플레이 시간 약 15분
- 점수 기록은 게임 종료 시점에 1회 발생

따라서 온라인 플랫폼과 달리,  
**물리적으로 동시 요청 수에 상한선이 존재하는 구조**를 가집니다.

---

## 1-1. 이론적 최대 동시 플레이 수 계산

현재 매장 수: 35개  
매장당 평균 방 수: 5개  

이는 이론적 최대치이며,  
모든 방이 동시에 가동되는 상황은 드물기 때문에  
실제 동시 플레이 수는 이보다 낮을 가능성이 높습니다.

---

## 2. 요청 유형 분석

요청은 크게 Write와 Read로 구분됩니다.

---

### 2-1. Write 요청 (점수 기록)

- 발생 시점: 게임 종료 시
- 발생 횟수: 팀당 1회
- 평균 플레이 시간: 15분

이론적으로 **모든 팀이 동시에 게임을 시작한 경우**,  
15분 뒤 **동일한 시점에 최대 175건의 Write가 몰릴 수 있습니다.**

그러나 실제 운영 환경에서는:

- 팀별 입장 시점이 서로 다르고  
- 각 방의 게임 시작 시간이 동일하지 않으며  
- 매장별 고객 흐름도 일정하지 않기 때문에  

Write 요청은 단일 초에 집중되지 않고 **시간적으로 자연스럽게 분산되어 발생**합니다.
---

### 2-2. Read 요청 (랭킹 조회)

- 매장 내 랭킹 조회
- 전국 랭킹 조회
- 관리자 대시보드 조회

랭킹 조회는 주로:
- 게임을 마친 팀
- 대기 중인 고객
- 매장 직원

에 의해 발생합니다.

주말 등 피크 시간대에 조회 요청이 증가할 수 있으나,  
동시 플레이 팀 수 자체가 물리적으로 제한되므로  
고빈도 대규모 burst 트래픽 가능성은 낮습니다.

---

## 3. 트래픽 성격 요약

점핑배틀은 다음과 같은 트래픽 특성을 가집니다:

- 지속적 고빈도 요청 구조가 아님
- 초고속 실시간 집계 서비스가 아님
- 물리적 제약 기반의 분산형 요청 구조

따라서 현재 트래픽 규모에서는  
추가적인 캐시 계층(예: Redis)을 도입하지 않더라도  
Firestore 단독 구조로 충분하다고 판단했습니다.

---
## 4. 캐시 전략

현재 서비스는 단일 서버 환경에서 운영되고 있으며,
프로세스 내부 메모리 기반 캐시(flask-cache)를 활용하여
반복 조회되는 랭킹 데이터를 일정 시간 동안 캐싱하고 있습니다.

이는 단일 인스턴스 환경에서의 응답 속도 개선을 위한 경량 최적화 전략입니다.

다만, Redis와 같은 외부 분산 캐시 계층은 다음과 같은 경우에 필요성이 증가합니다:

- 다중 서버 인스턴스 운영
- 초당 수십~수백 건 이상의 랭킹 조회 발생
- 실시간 순위 반영 요구사항 추가

현재 트래픽 모델과 인프라 구조에서는
프로세스 내부 캐시만으로도 충분한 성능을 확보할 수 있다고 판단하였으며,

분산 캐시 도입에 따른 운영 복잡도 증가 대비 효용이 제한적이라고 판단하여
외부 캐시 계층은 도입하지 않았습니다.
이론적으로 모든 팀이 동시에 게임을 시작했다고 가정해도,  
15분 동안 175건의 Write가 분산되어 발생합니다.
